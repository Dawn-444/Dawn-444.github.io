<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CocoPPa Playæ‰­è›‹æ—¥å†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.8rem;
            color: #2c3e50;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
            position: relative;
            display: inline-block;
        }
        
        h1:after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 4px;
            background: linear-gradient(90deg, #3498db, #9b59b6);
            border-radius: 2px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #7f8c8d;
            max-width: 800px;
            margin: 20px auto 0;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.7);
            padding: 12px 25px;
            border-radius: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }
        
        .image-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 640px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }
        
        .date-display {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
        }
        
        .date-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            width: 100%;
        }
        
        .date-info {
            text-align: center;
            flex: 1;
        }
        
        .day-number {
            font-size: 2.8rem;
            font-weight: 700;
            line-height: 1;
            color: #2c3e50;
        }
        
        .day-info {
            font-size: 1.2rem;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .type-tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            max-width: 350px;
            flex: 1;
            min-height: 40px; /* ç¡®ä¿æœ‰å›ºå®šé«˜åº¦ */
        }
        
        .type-tag {
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        
        /* å¤‡æ³¨åŒºåŸŸæ ·å¼ */
        .note-container {
            background: #fffde7;
            border-left: 4px solid #ffd54f;
            border-radius: 8px;
            padding: 12px 15px;
            width: 100%;
            position: relative;
        }
        
        .note-content {
            font-size: 0.95rem;
            color: #5d4037;
            max-height: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }
        
        .note-edit-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #ffd54f;
            color: #5d4037;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .note-edit-btn:hover {
            background: #ffc107;
            transform: scale(1.1);
        }
        
        /* å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ - è‡ªé€‚åº” */
        .image-display {
            position: relative;
            width: 100%;
            max-width: 640px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
            transition: all 0.3s ease;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #e0e7ff;
        }
        
        /* ä¸åŒæ—¥æœŸèŒƒå›´çš„å›¾ç‰‡å°ºå¯¸ */
        .size-640x480 {
            aspect-ratio: 640/480;
        }
        
        .size-640x580 {
            aspect-ratio: 640/580;
        }
        
        .size-640x624 {
            aspect-ratio: 640/624;
        }
        
        .size-default {
            aspect-ratio: 640/654;
        }
        
        .gallery-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .gallery-slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 100%;
        }
        
        .gallery-slide {
            min-width: 100%;
            height: 100%;
        }
        
        .gallery-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-indicators {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            z-index: 20;
        }
        
        .gallery-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .gallery-indicator.active {
            background: #3498db;
            transform: scale(1.2);
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3498db;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .gallery-nav:hover {
            background: #3498db;
            color: white;
            transform: translateY(-50%) scale(1.1);
        }
        
        .gallery-prev {
            left: 15px;
        }
        
        .gallery-next {
            right: 15px;
        }
        
        .image-display.empty .gallery-container {
            display: none;
        }
        
        .image-display .empty-image {
            display: none;
            font-size: 1.2rem;
            color: #95a5a6;
            text-align: center;
            padding: 20px;
        }
        
        .image-display.empty .empty-image {
            display: block;
        }
        
        .upload-container {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 10;
            display: flex;
            gap: 10px;
        }
        
        .upload-btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .remove-btn {
            padding: 10px 20px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(149, 165, 166, 0.3);
        }
        
        .save-btn {
            padding: 10px 20px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(46, 204, 113, 0.3);
        }
        
        .share-btn {
            padding: 10px 20px;
            background: #9b59b6;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(155, 89, 182, 0.3);
        }
        
        .clear-btn {
            padding: 10px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(231, 76, 60, 0.3);
        }
        
        .toggle-btn {
            padding: 10px 15px;
            background: #34495e;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(52, 73, 94, 0.3);
        }
        
        .upload-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .remove-btn:hover {
            background: #7f8c8d;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(127, 140, 141, 0.4);
        }
        
        .save-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(39, 174, 96, 0.4);
        }
        
        .share-btn:hover {
            background: #8e44ad;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(142, 68, 173, 0.4);
        }
        
        .clear-btn:hover {
            background: #c0392b;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(192, 57, 43, 0.4);
        }
        
        .toggle-btn:hover {
            background: #2c3e50;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(44, 62, 80, 0.4);
        }
        
        .calendar-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .year-month-control {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .year-select {
            padding: 8px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: #f8f9fa;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .month-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .month-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            min-width: 180px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #7f8c8d;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .control-btn:hover {
            background: #3498db;
            color: white;
            transform: scale(1.05);
        }
        
        .quick-month-select {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .month-btn {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .month-btn:hover, .month-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .legend {
            display: none;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        
        .day-header {
            text-align: center;
            padding: 15px 0;
            font-weight: 600;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: #f8fafd;
            border-radius: 8px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            background: #f8f9fa;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .calendar-day:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            background: #e3f2fd;
        }
        
        .calendar-day:hover .day-actions {
            opacity: 1;
            transform: translateY(0);
        }
        
        .day-number-small {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
            z-index: 2;
            margin-bottom: 5px;
        }
        
        .day-types {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 4px;
            max-height: 40px;
            overflow-y: auto;
            padding: 2px;
            z-index: 2;
            width: 100%;
        }
        
        .day-type {
            font-size: 0.6rem;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
            padding: 3px 6px;
            border-radius: 20px;
            z-index: 2;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        
        .day-actions {
            position: absolute;
            bottom: 5px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 5px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 3;
        }
        
        .day-action-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .day-action-btn:hover {
            transform: scale(1.1);
        }
        
        .set-type-btn {
            color: #3498db;
        }
        
        .upload-img-btn {
            color: #2ecc71;
        }
        
        .remove-type-btn {
            color: #e74c3c;
        }
        
        .note-day-btn {
            color: #ff9800;
        }
        
        .empty-day {
            background: transparent;
            box-shadow: none;
            cursor: default;
        }
        
        .empty-day:hover {
            transform: none;
            box-shadow: none;
            background: transparent;
        }
        
        .today .day-number-small {
            color: #e74c3c;
        }
        
        .today::after {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            background: #e74c3c;
            border-radius: 50%;
        }
        
        /* æ‰­è›‹ç±»å‹æ ·å¼ */
        .type-first-gold {
            background-color: rgba(46, 204, 113, 0.2);
        }
        .type-first-ticket {
            background-color: rgba(52, 152, 219, 0.2);
        }
        .type-remix-gold {
            background-color: rgba(155, 89, 182, 0.2);
        }
        .type-spremix-gold {
            background-color: rgba(231, 76, 60, 0.2);
        }
        .type-remix-ticket {
            background-color: rgba(241, 196, 15, 0.2);
        }
        .type-collection {
            background-color: rgba(255, 105, 180, 0.2);
        }
        .type-theme-profile {
            background-color: rgba(30, 144, 255, 0.2);
        }
        .type-gacha-festival {
            background-color: rgba(138, 43, 226, 0.2);
        }
        
        /* æ‰­è›‹ç±»å‹æ ‡ç­¾æ ·å¼ */
        .type-first-gold .day-type {
            background: #2ecc71;
        }
        .type-first-ticket .day-type {
            background: #3498db;
        }
        .type-remix-gold .day-type {
            background: #9b59b6;
        }
        .type-spremix-gold .day-type {
            background: #e74c3c;
        }
        .type-remix-ticket .day-type {
            background: #f1c40f;
        }
        .type-collection .day-type {
            background: #ff69b4;
        }
        .type-theme-profile .day-type {
            background: #1e90ff;
        }
        .type-gacha-festival .day-type {
            background: #8a2be2;
        }
        
        .type-selector-menu {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            padding: 10px;
            z-index: 100;
            display: none;
            min-width: 180px;
        }
        
        .type-selector-menu.show {
            display: block;
        }
        
        .type-option {
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .type-option:hover {
            background: #f5f7fa;
        }
        
        .type-option.selected {
            background: #e3f2fd;
            position: relative;
        }
        
        .type-option.selected::after {
            content: 'âœ“';
            position: absolute;
            right: 10px;
            color: #3498db;
            font-weight: bold;
        }
        
        .type-option-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            display: inline-block;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        .gacha-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #3498db;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 3px 10px rgba(52, 152, 219, 0.3);
            z-index: 11;
        }
        
        .save-share-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .share-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .share-url-container {
            display: flex;
            margin-top: 20px;
        }
        
        .share-url-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px 0 0 8px;
            font-size: 1rem;
        }
        
        .copy-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            font-weight: 600;
        }
        
        .copy-btn:hover {
            background: #2980b9;
        }
        
        .copy-success {
            color: #2ecc71;
            font-weight: 600;
            text-align: center;
            margin-top: 15px;
            display: none;
        }
        
        .auto-save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(46, 204, 113, 0.3);
            z-index: 100;
            display: none;
        }
        
        .clear-confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .clear-confirm-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            position: relative;
            text-align: center;
        }
        
        .clear-confirm-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .preview-item {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }
        
        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .preview-item .remove-preview {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.8);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .preview-item:hover .remove-preview {
            opacity: 1;
        }
        
        .upload-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            background: #e3f2fd;
            text-align: center;
            font-weight: 500;
            color: #1976d2;
            display: none;
        }
        
        /* å¤‡æ³¨æ¨¡æ€æ¡†æ ·å¼ */
        .note-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .note-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        .note-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .note-modal-title {
            font-size: 1.5rem;
            color: #2c3e50;
        }
        
        .note-textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 20px;
            font-family: inherit;
        }
        
        .note-textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .emoji-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 20px;
            max-height: 120px;
            overflow-y: auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .emoji-btn {
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            transition: transform 0.2s;
        }
        
        .emoji-btn:hover {
            transform: scale(1.2);
        }
        
        .note-modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .note-cancel-btn {
            padding: 10px 20px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .note-save-btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .note-cancel-btn:hover {
            background: #7f8c8d;
        }
        
        .note-save-btn:hover {
            background: #2980b9;
        }
        
        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .image-section {
                max-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .date-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .calendar-header {
                flex-direction: column;
            }
            
            .year-month-control {
                flex-direction: column;
                width: 100%;
            }
            
            .year-select {
                width: 100%;
            }
            
            .quick-month-select {
                justify-content: center;
            }
            
            .calendar-grid {
                gap: 5px;
            }
            
            .day-number-small {
                font-size: 1.1rem;
            }
            
            .day-type {
                font-size: 0.55rem;
                padding: 1px 5px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .upload-container {
                flex-direction: column;
                align-items: flex-end;
                width: 100%;
                right: 10px;
                bottom: 10px;
            }
            
            .day-actions {
                gap: 3px;
            }
            
            .day-action-btn {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
            
            .save-share-container {
                flex-direction: column;
                align-items: center;
            }
            
            .image-section {
                max-width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>CocoPPa Playæ‰­è›‹æ—¥å†</h1>
            <p class="subtitle">è®°å½•æ‚¨çš„æ‰­è›‹å†å²ï¼Œæ—¥æœŸæ˜¾ç¤ºæ›´æ¸…æ™° - ç®¡ç†æ‚¨çš„æ‰­è›‹æ”¶é›†ï¼Œä¼˜åŒ–æ‰­è›‹ç­–ç•¥ï¼</p>
        </header>

        <div class="main-content">
            <div class="image-section">
                <!-- æ—¥æœŸæ˜¾ç¤ºåŒºåŸŸ - æ‰­è›‹ç±»å‹å›ºå®šåœ¨é¡¶éƒ¨ -->
                <div class="date-display">
                    <div class="date-header">
                        <div class="date-info">
                            <div class="day-number" id="current-day-number">14</div>
                            <div class="day-info" id="current-day-info">6æœˆ 2025</div>
                        </div>
                        <div class="type-tag-container" id="type-tag-container">
                            <div class="type-tag" style="background: #8a2be2; color: white;">Gacha Festival</div>
                            <div class="type-tag" style="background: #ff69b4; color: white;">Collection</div>
                        </div>
                    </div>
                    
                    <!-- å¤‡æ³¨æ˜¾ç¤ºåŒºåŸŸ -->
                    <div class="note-container" id="note-container" style="display: none;">
                        <div class="note-content" id="note-content"></div>
                        <div class="note-edit-btn" id="edit-note-btn">
                            <i class="fas fa-edit"></i>
                        </div>
                    </div>
                </div>
                
                <!-- å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ - å°ºå¯¸è‡ªé€‚åº” -->
                <div class="image-display size-default" id="image-container">
                    <div class="gallery-container">
                        <div class="gallery-slides">
                            <div class="gallery-slide">
                                <img src="https://images.unsplash.com/photo-1585314062340-f1a5a7c9328d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=640&h=654&crop=entropy" alt="æ‰­è›‹å›¾ç‰‡">
                            </div>
                            <div class="gallery-slide">
                                <img src="https://images.unsplash.com/photo-1598327105666-5b89351aff97?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=640&h=654&crop=entropy" alt="æ‰­è›‹å›¾ç‰‡">
                            </div>
                        </div>

                        <div class="gallery-nav gallery-prev">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                        <div class="gallery-nav gallery-next">
                            <i class="fas fa-chevron-right"></i>
                        </div>

                        <div class="gallery-indicators">
                            <div class="gallery-indicator active"></div>
                            <div class="gallery-indicator"></div>
                        </div>
                    </div>

                    <div class="empty-image">
                        <i class="fas fa-image" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>å½“å‰æ—¥æœŸæ— æ‰­è›‹è®°å½•</p>
                        <p>è¯·ä¸Šä¼ å›¾ç‰‡æˆ–é€‰æ‹©å…¶ä»–æ—¥æœŸ</p>
                    </div>

                    <div class="upload-container">
                        <button class="upload-btn" id="upload-btn">
                            <i class="fas fa-upload"></i> ä¸Šä¼ å¤šå›¾
                        </button>
                        <button class="remove-btn" id="remove-btn">
                            <i class="fas fa-trash"></i> åˆ é™¤è®°å½•
                        </button>
                    </div>
                    
                    <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
                    <div class="preview-container" id="preview-container" style="display: none;"></div>
                    <div class="upload-status" id="upload-status"></div>
                </div>
            </div>

            <div class="calendar-section">
                <div class="calendar-header">
                    <div class="year-month-control">
                        <select class="year-select" id="year-select">
                            <!-- å¹´ä»½é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </select>

                        <div class="month-control">
                            <button class="control-btn" id="prev-month"><i class="fas fa-chevron-left"></i></button>
                            <div class="month-name" id="month-name">2025å¹´6æœˆ</div>
                            <button class="control-btn" id="next-month"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <!-- æ—¥å†å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="save-share-container">
                    <button class="save-btn" id="save-data-btn">
                        <i class="fas fa-save"></i> å¯¼å‡ºæ•°æ®
                    </button>
                    <button class="share-btn" id="share-data-btn">
                        <i class="fas fa-share-alt"></i> åˆ›å»ºåˆ†äº«é“¾æ¥
                    </button>
                    <button class="clear-btn" id="clear-data-btn">
                        <i class="fas fa-broom"></i> æ¸…é™¤æ‰€æœ‰æ—¥æœŸ
                    </button>
                </div>
            </div>
        </div>

        <footer>
            <p>CocoPPa Playæ‰­è›‹æ—¥å† &copy; 2025 | HTTPSå®‰å…¨è¿æ¥ | æ•°æ®è‡ªåŠ¨ä¿å­˜</p>
        </footer>

        <!-- ç±»å‹é€‰æ‹©èœå• -->
        <div class="type-selector-menu" id="type-selector-menu">
            <div class="type-option" data-type="é¦–å‘é‡‘">
                <div class="type-option-color" style="background: #2ecc71;"></div>
                <span>é¦–å‘é‡‘</span>
            </div>
            <div class="type-option" data-type="é¦–å‘ç¥¨">
                <div class="type-option-color" style="background: #3498db;"></div>
                <span>é¦–å‘ç¥¨</span>
            </div>
            <div class="type-option" data-type="remixé‡‘">
                <div class="type-option-color" style="background: #9b59b6;"></div>
                <span>remixé‡‘</span>
            </div>
            <div class="type-option" data-type="SPremixé‡‘">
                <div class="type-option-color" style="background: #e74c3c;"></div>
                <span>SPremixé‡‘</span>
            </div>
            <div class="type-option" data-type="remixç¥¨">
                <div class="type-option-color" style="background: #f1c40f;"></div>
                <span>remixç¥¨</span>
            </div>
            <div class="type-option" data-type="Collection">
                <div class="type-option-color" style="background: #ff69b4;"></div>
                <span>Collection</span>
            </div>
            <div class="type-option" data-type="Theme & Profile">
                <div class="type-option-color" style="background: #1e90ff;"></div>
                <span>Theme & Profile</span>
            </div>
            <div class="type-option" data-type="Gacha Festival">
                <div class="type-option-color" style="background: #8a2be2;"></div>
                <span>Gacha Festival</span>
            </div>
        </div>
        
        <!-- åˆ†äº«æ¨¡æ€æ¡† -->
        <div class="share-modal" id="share-modal">
            <div class="share-modal-content">
                <span class="close-modal" id="close-share-modal">&times;</span>
                <h3>åˆ†äº«æ‚¨çš„æ‰­è›‹æ—¥å†</h3>
                <p>å¤åˆ¶ä»¥ä¸‹é“¾æ¥åˆ†äº«ç»™å…¶ä»–ç©å®¶ï¼š</p>
                <div class="share-url-container">
                    <input type="text" class="share-url-input" id="share-url-input" readonly value="https://cocoppa-play-calendar.com/share/8a2be2d9">
                    <button class="copy-btn" id="copy-share-btn">å¤åˆ¶</button>
                </div>
                <div class="copy-success" id="copy-success">âœ“ é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>
                <div style="margin-top: 20px; background: #f9f9f9; padding: 15px; border-radius: 8px;">
                    <h4>å®‰å…¨åˆ†äº«æç¤ºï¼š</h4>
                    <p>â€¢ æ­¤é“¾æ¥é€šè¿‡HTTPSåŠ å¯†ä¼ è¾“ï¼Œç¡®ä¿æ‚¨çš„æ•°æ®å®‰å…¨</p>
                    <p>â€¢ åˆ†äº«åå…¶ä»–ç©å®¶å¯ä»¥æŸ¥çœ‹æ‚¨çš„æ‰­è›‹å†å²</p>
                    <p>â€¢ é“¾æ¥æœ‰æ•ˆæœŸï¼š30å¤©</p>
                </div>
            </div>
        </div>
        
        <!-- æ¸…é™¤ç¡®è®¤æ¨¡æ€æ¡† -->
        <div class="clear-confirm-modal" id="clear-confirm-modal">
            <div class="clear-confirm-content">
                <span class="close-modal" id="close-clear-modal">&times;</span>
                <h3>ç¡®è®¤æ¸…é™¤æ‰€æœ‰æ•°æ®</h3>
                <p>æ‚¨ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æ—¥æœŸçš„æ‰­è›‹è®°å½•å—ï¼Ÿ</p>
                <p>æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ‰€æœ‰å·²ä¿å­˜çš„æ•°æ®ï¼Œä¸”æ— æ³•æ¢å¤ï¼</p>
                <div class="clear-confirm-buttons">
                    <button class="save-btn" id="cancel-clear-btn">å–æ¶ˆ</button>
                    <button class="clear-btn" id="confirm-clear-btn">ç¡®è®¤æ¸…é™¤</button>
                </div>
            </div>
        </div>
        
        <!-- è‡ªåŠ¨ä¿å­˜æŒ‡ç¤ºå™¨ -->
        <div class="auto-save-indicator" id="auto-save-indicator">
            <i class="fas fa-sync-alt"></i> æ•°æ®å·²è‡ªåŠ¨ä¿å­˜
        </div>
        
        <!-- å¤‡æ³¨ç¼–è¾‘æ¨¡æ€æ¡† -->
        <div class="note-modal" id="note-modal">
            <div class="note-modal-content">
                <div class="note-modal-header">
                    <h3 class="note-modal-title">æ·»åŠ å¤‡æ³¨</h3>
                    <span class="close-modal" id="close-note-modal">&times;</span>
                </div>
                <p>ä¸º <strong id="note-date-display">2025å¹´6æœˆ14æ—¥</strong> æ·»åŠ å¤‡æ³¨ï¼š</p>
                <textarea class="note-textarea" id="note-textarea" placeholder="è¾“å…¥æ‰­è›‹è¯¦æƒ…ã€wikié“¾æ¥ç­‰..."></textarea>
                
                <div class="emoji-picker">
                    <button class="emoji-btn" data-emoji="ğŸ˜€">ğŸ˜€</button>
                    <button class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                    <button class="emoji-btn" data-emoji="ğŸ‰">ğŸ‰</button>
                    <button class="emoji-btn" data-emoji="ğŸ">ğŸ</button>
                    <button class="emoji-btn" data-emoji="ğŸ’">ğŸ’</button>
                    <button class="emoji-btn" data-emoji="âœ¨">âœ¨</button>
                    <button class="emoji-btn" data-emoji="â­">â­</button>
                    <button class="emoji-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                    <button class="emoji-btn" data-emoji="ğŸ’–">ğŸ’–</button>
                    <button class="emoji-btn" data-emoji="ğŸ’¯">ğŸ’¯</button>
                    <button class="emoji-btn" data-emoji="ğŸ¯">ğŸ¯</button>
                    <button class="emoji-btn" data-emoji="â¤ï¸">â¤ï¸</button>
                    <button class="emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                    <button class="emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                    <button class="emoji-btn" data-emoji="ğŸ™Œ">ğŸ™Œ</button>
                </div>
                
                <div class="note-modal-actions">
                    <button class="note-cancel-btn" id="note-cancel-btn">å–æ¶ˆ</button>
                    <button class="note-save-btn" id="note-save-btn">ä¿å­˜å¤‡æ³¨</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOMå…ƒç´ 
            const dayNumber = document.getElementById('current-day-number');
            const dayInfo = document.getElementById('current-day-info');
            const typeTagContainer = document.getElementById('type-tag-container');
            const imageContainer = document.getElementById('image-container');
            const uploadBtn = document.getElementById('upload-btn');
            const removeBtn = document.getElementById('remove-btn');
            const saveDataBtn = document.getElementById('save-data-btn');
            const shareDataBtn = document.getElementById('share-data-btn');
            const clearDataBtn = document.getElementById('clear-data-btn');
            const gallerySlides = document.querySelector('.gallery-slides');
            const galleryIndicators = document.querySelector('.gallery-indicators');
            const galleryPrev = document.querySelector('.gallery-prev');
            const galleryNext = document.querySelector('.gallery-next');
            const shareModal = document.getElementById('share-modal');
            const closeShareModal = document.getElementById('close-share-modal');
            const shareUrlInput = document.getElementById('share-url-input');
            const copyShareBtn = document.getElementById('copy-share-btn');
            const copySuccess = document.getElementById('copy-success');
            const clearConfirmModal = document.getElementById('clear-confirm-modal');
            const closeClearModal = document.getElementById('close-clear-modal');
            const cancelClearBtn = document.getElementById('cancel-clear-btn');
            const confirmClearBtn = document.getElementById('confirm-clear-btn');
            const autoSaveIndicator = document.getElementById('auto-save-indicator');
            const previewContainer = document.getElementById('preview-container');
            const uploadStatus = document.getElementById('upload-status');
            const yearSelect = document.getElementById('year-select');
            
            // å¤‡æ³¨ç›¸å…³å…ƒç´ 
            const noteContainer = document.getElementById('note-container');
            const noteContent = document.getElementById('note-content');
            const editNoteBtn = document.getElementById('edit-note-btn');
            const noteModal = document.getElementById('note-modal');
            const closeNoteModal = document.getElementById('close-note-modal');
            const noteTextarea = document.getElementById('note-textarea');
            const noteSaveBtn = document.getElementById('note-save-btn');
            const noteCancelBtn = document.getElementById('note-cancel-btn');
            const noteDateDisplay = document.getElementById('note-date-display');
            
            // æ–‡ä»¶è¾“å…¥
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';
            fileInput.multiple = true;
            fileInput.style.display = 'none';
            document.body.appendChild(fileInput);
            
            // æ—¥å†ç›¸å…³å…ƒç´ 
            const monthName = document.getElementById('month-name');
            const calendarGrid = document.getElementById('calendar-grid');
            const prevBtn = document.getElementById('prev-month');
            const nextBtn = document.getElementById('next-month');
            const typeSelectorMenu = document.getElementById('type-selector-menu');
            
            // è·å–å½“å‰æ—¥æœŸ
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth() + 1;
            const currentDay = today.getDate();
            
            // å½“å‰é€‰ä¸­çš„æ—¥æœŸï¼ˆé»˜è®¤ä¸ºä»Šå¤©ï¼‰
            let currentDate = {
                year: currentYear,
                month: currentMonth,
                day: currentDay
            };
            
            // å½“å‰æ“ä½œçš„ç›®æ ‡æ—¥æœŸ
            let targetDay = null;
            
            // è½®æ’­å›¾çŠ¶æ€
            let currentSlide = 0;
            let slideInterval;
            
            // åˆå§‹åŒ–å¹´ä»½é€‰æ‹©å™¨ (2014-2026)
            function initYearSelector() {
                yearSelect.innerHTML = '';
                for (let year = 2014; year <= 2026; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = `${year}å¹´`;
                    if (year === currentYear) {
                        option.selected = true;
                    }
                    yearSelect.appendChild(option);
                }
            }
            
            // åˆå§‹åŒ–æ•°æ®
            let imageData = {
                "2025-6": {
                    14: { 
                        types: ["Gacha Festival", "Collection"],
                        images: [
                            "https://images.unsplash.com/photo-1585314062340-f1a5a7c9328d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=640&h=654&crop=entropy",
                            "https://images.unsplash.com/photo-1598327105666-5b89351aff97?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=640&h=654&crop=entropy"
                        ],
                        note: "æŠ½åˆ°äº†ç¨€æœ‰è§’è‰²ï¼ğŸ‰ èŠ±è´¹äº†500é‡‘å¸ï¼Œä½†éå¸¸å€¼å¾—ï¼" 
                    },
                    5: { 
                        types: ["é¦–å‘é‡‘"], 
                        note: "ç¬¬ä¸€æ¬¡æŠ½å¥–ï¼Œè¿æ°”ä¸é”™" 
                    },
                    12: { 
                        types: ["é¦–å‘ç¥¨"], 
                        note: "å…è´¹æŠ½å¥–æ—¥ï¼ŒæŠ½åˆ°äº†æ™®é€šç‰©å“" 
                    },
                    18: { 
                        types: ["Collection"], 
                        note: "æ”¶é›†æ´»åŠ¨ï¼ŒæŠ½åˆ°äº†3ä¸ªæ–°ç‰©å“" 
                    },
                    25: { 
                        types: ["remixé‡‘", "Collection"], 
                        images: [],
                        note: "åŒå€æ¦‚ç‡æ—¥ï¼Œä½†è¿æ°”ä¸€èˆ¬ğŸ’”" 
                    }
                },
                "2025-7": {
                    3: { 
                        types: ["SPremixé‡‘"], 
                        note: "SPæ‰­è›‹ï¼ŒæŠ½åˆ°äº†é™å®šè§’è‰²ï¼ğŸ”¥" 
                    },
                    8: { 
                        types: ["Gacha Festival"], 
                        note: "èŠ‚æ—¥æ´»åŠ¨ï¼ŒæŠ½åˆ°äº†ç‰¹æ®ŠèƒŒæ™¯" 
                    },
                    15: { 
                        types: ["Theme & Profile"], 
                        note: "æ–°ä¸»é¢˜æŠ½å¥–ï¼ŒèŠ±è´¹è¾ƒå¤šä½†å€¼å¾—" 
                    },
                    22: { 
                        types: ["remixç¥¨"], 
                        note: "ä½¿ç”¨å…è´¹ç¥¨æŠ½å¥–ï¼Œæ— ç¨€æœ‰ç‰©å“" 
                    },
                    29: { 
                        types: ["é¦–å‘é‡‘"], 
                        note: "æœˆåº•æŠ½å¥–ï¼ŒæŠ½åˆ°äº†æƒ³è¦çš„ç‰©å“â¤ï¸" 
                    }
                },
                // æ·»åŠ å½“å‰æ—¥æœŸç¤ºä¾‹æ•°æ®
                [currentYear + "-" + currentMonth]: {
                    [currentDay]: {
                        types: ["Gacha Festival"],
                        note: "ä»Šæ—¥æ‰­è›‹è®°å½•ï¼ŒæŠ½åˆ°äº†é™å®šç‰©å“ï¼"
                    }
                }
            };
            
            // ç±»å‹å¯¹åº”çš„é¢œè‰²
            const typeColors = {
                "é¦–å‘é‡‘": "#2ecc71",
                "é¦–å‘ç¥¨": "#3498db",
                "remixé‡‘": "#9b59b6",
                "SPremixé‡‘": "#e74c3c",
                "remixç¥¨": "#f1c40f",
                "Collection": "#ff69b4",
                "Theme & Profile": "#1e90ff",
                "Gacha Festival": "#8a2be3"
            };
            
            // ç±»å‹å¯¹åº”çš„CSSç±»
            const typeClasses = {
                "é¦–å‘é‡‘": "type-first-gold",
                "é¦–å‘ç¥¨": "type-first-ticket",
                "remixé‡‘": "type-remix-gold",
                "SPremixé‡‘": "type-spremix-gold",
                "remixç¥¨": "type-remix-ticket",
                "Collection": "type-collection",
                "Theme & Profile": "type-theme-profile",
                "Gacha Festival": "type-gacha-festival"
            };
            
            // åˆå§‹åŒ–è½®æ’­å›¾
            function initGallery() {
                // æ¸…é™¤ç°æœ‰è½®æ’­å†…å®¹
                gallerySlides.innerHTML = '';
                galleryIndicators.innerHTML = '';
                
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[currentDate.day] || {};
                const images = dayData.images || [];
                
                if (images.length === 0) {
                    imageContainer.classList.add('empty');
                } else {
                    imageContainer.classList.remove('empty');
                    
                    // æ·»åŠ è½®æ’­å›¾ç‰‡
                    images.forEach((img, index) => {
                        const slide = document.createElement('div');
                        slide.className = 'gallery-slide';
                        slide.innerHTML = `<img src="${img}" alt="æ‰­è›‹å›¾ç‰‡">`;
                        gallerySlides.appendChild(slide);
                        
                        // æ·»åŠ æŒ‡ç¤ºå™¨
                        const indicator = document.createElement('div');
                        indicator.className = 'gallery-indicator';
                        if (index === 0) indicator.classList.add('active');
                        indicator.addEventListener('click', () => goToSlide(index));
                        galleryIndicators.appendChild(indicator);
                    });
                    
                    currentSlide = 0;
                    updateSlidePosition();
                    
                    // å¼€å§‹è‡ªåŠ¨è½®æ’­
                    startAutoSlide();
                }
                
                // æ›´æ–°å¤‡æ³¨æ˜¾ç¤º
                updateNoteDisplay();
            }
            
            // æ›´æ–°å¤‡æ³¨æ˜¾ç¤º
            function updateNoteDisplay() {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[currentDate.day] || {};
                
                if (dayData.note) {
                    noteContent.innerHTML = dayData.note;
                    noteContainer.style.display = 'block';
                } else {
                    noteContainer.style.display = 'none';
                }
            }
            
            // æ›´æ–°è½®æ’­ä½ç½®
            function updateSlidePosition() {
                gallerySlides.style.transform = `translateX(-${currentSlide * 100}%)`;
                
                // æ›´æ–°æŒ‡ç¤ºå™¨çŠ¶æ€
                document.querySelectorAll('.gallery-indicator').forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === currentSlide);
                });
            }
            
            // å‰å¾€ç‰¹å®šå¹»ç¯ç‰‡
            function goToSlide(index) {
                currentSlide = index;
                updateSlidePosition();
            }
            
            // ä¸‹ä¸€å¼ å¹»ç¯ç‰‡
            function nextSlide() {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[currentDate.day] || {};
                const images = dayData.images || [];
                
                if (images.length === 0) return;
                
                currentSlide = (currentSlide + 1) % images.length;
                updateSlidePosition();
            }
            
            // ä¸Šä¸€å¼ å¹»ç¯ç‰‡
            function prevSlide() {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[currentDate.day] || {};
                const images = dayData.images || [];
                
                if (images.length === 0) return;
                
                currentSlide = (currentSlide - 1 + images.length) % images.length;
                updateSlidePosition();
            }
            
            // å¼€å§‹è‡ªåŠ¨è½®æ’­
            function startAutoSlide() {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 5000);
            }
            
            // æ ¹æ®æ—¥æœŸè®¾ç½®å›¾ç‰‡å°ºå¯¸
            function setImageSizeByDate() {
                // ç§»é™¤æ‰€æœ‰å°ºå¯¸ç±»
                imageContainer.classList.remove('size-640x480', 'size-640x580', 'size-640x624', 'size-default');
                
                // è®¡ç®—å½“å‰æ—¥æœŸçš„æ•°å­—è¡¨ç¤º
                const dateNum = currentDate.year * 10000 + currentDate.month * 100 + currentDate.day;
                
                // 2017å¹´5æœˆ26æ—¥~2019å¹´7æœˆ9æ—¥ (640x580)
                if (dateNum >= 20170526 && dateNum <= 20190709) {
                    imageContainer.classList.add('size-640x580');
                }
                // 2014å¹´12æœˆ1æ—¥~2017å¹´5æœˆ25æ—¥ (640x480)
                else if (dateNum >= 20141201 && dateNum <= 20170525) {
                    imageContainer.classList.add('size-640x480');
                }
                // 2014å¹´7æœˆ24æ—¥~2014å¹´11æœˆ30æ—¥ (640x624)
                else if (dateNum >= 20140724 && dateNum <= 20141130) {
                    imageContainer.classList.add('size-640x624');
                }
                // å…¶ä»–æ—¥æœŸ
                else {
                    imageContainer.classList.add('size-default');
                }
            }
            
            // ç”Ÿæˆæ—¥å†
            function generateCalendar() {
                const monthData = getMonthData(currentDate.year, currentDate.month);
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                
                // æ›´æ–°æœˆä»½åç§°
                monthName.textContent = `${currentDate.year}å¹´${monthData.name}`;
                
                // æ›´æ–°å¹´ä»½é€‰æ‹©
                yearSelect.value = currentDate.year;
                
                // æ¸…ç©ºæ—¥å†ç½‘æ ¼
                calendarGrid.innerHTML = '';
                
                // æ·»åŠ æ˜ŸæœŸæ ‡é¢˜
                const dayNames = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
                dayNames.forEach(day => {
                    const dayHeader = document.createElement('div');
                    dayHeader.className = 'day-header';
                    dayHeader.textContent = day;
                    calendarGrid.appendChild(dayHeader);
                });
                
                // æ·»åŠ ç©ºç™½å•å…ƒæ ¼
                for (let i = 0; i < monthData.startDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'empty-day';
                    calendarGrid.appendChild(emptyDay);
                }
                
                // è·å–å½“å‰æ—¥æœŸ
                const today = new Date();
                const isCurrentYear = currentDate.year === today.getFullYear();
                const isCurrentMonth = currentDate.month === today.getMonth() + 1;
                
                // æ·»åŠ æ—¥æœŸå•å…ƒæ ¼
                for (let day = 1; day <= monthData.days; day++) {
                    const dayData = imageData[monthKey]?.[day] || {};
                    const dayTypes = dayData.types || [];
                    
                    // æ£€æŸ¥æ˜¯å¦æ˜¯ä»Šå¤©
                    const isToday = isCurrentYear && isCurrentMonth && day === today.getDate();
                    
                    const calendarDay = document.createElement('div');
                    calendarDay.className = `calendar-day ${isToday ? 'today' : ''}`;
                    
                    // æ·»åŠ ç±»å‹ç±»ï¼ˆåªå–ç¬¬ä¸€ä¸ªç±»å‹ä½œä¸ºèƒŒæ™¯ï¼‰
                    if (dayTypes.length > 0) {
                        const firstType = dayTypes[0];
                        calendarDay.classList.add(typeClasses[firstType] || '');
                    }
                    
                    if (currentDate.day === day) {
                        calendarDay.classList.add('active');
                    }
                    
                    // æ—¥æœŸæ ¼å­å†…å®¹
                    calendarDay.innerHTML = `
                        <div class="day-number-small">${day}</div>
                        <div class="day-types" id="day-types-${day}"></div>
                        <div class="day-actions">
                            <div class="day-action-btn set-type-btn" title="è®¾ç½®ç±»å‹">
                                <i class="fas fa-tag"></i>
                            </div>
                            <div class="day-action-btn upload-img-btn" title="ä¸Šä¼ å›¾ç‰‡">
                                <i class="fas fa-upload"></i>
                            </div>
                            ${dayTypes.length > 0 ? `<div class="day-action-btn remove-type-btn" title="åˆ é™¤ç±»å‹">
                                <i class="fas fa-trash-alt"></i>
                            </div>` : ''}
                            <div class="day-action-btn note-day-btn" title="æ·»åŠ å¤‡æ³¨">
                                <i class="fas fa-sticky-note"></i>
                            </div>
                        </div>
                    `;
                    
                    // æ·»åŠ ç±»å‹æ ‡ç­¾
                    const dayTypesContainer = calendarDay.querySelector('.day-types');
                    dayTypes.forEach(type => {
                        const typeTag = document.createElement('div');
                        typeTag.className = 'day-type';
                        typeTag.textContent = type;
                        typeTag.style.background = typeColors[type] || '#95a5a6';
                        dayTypesContainer.appendChild(typeTag);
                    });
                    
                    // æ·»åŠ æ—¥æœŸç‚¹å‡»äº‹ä»¶
                    calendarDay.addEventListener('click', (e) => {
                        if (!e.target.closest('.day-action-btn')) {
                            handleDayClick(day);
                        }
                    });
                    
                    // æ·»åŠ æ“ä½œæŒ‰é’®äº‹ä»¶
                    const setTypeBtn = calendarDay.querySelector('.set-type-btn');
                    const uploadImgBtn = calendarDay.querySelector('.upload-img-btn');
                    const removeTypeBtn = calendarDay.querySelector('.remove-type-btn');
                    const noteDayBtn = calendarDay.querySelector('.note-day-btn');
                    
                    if (setTypeBtn) {
                        setTypeBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            targetDay = day;
                            showTypeSelector(e.target.closest('.calendar-day'), dayTypes);
                        });
                    }
                    
                    if (uploadImgBtn) {
                        uploadImgBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            targetDay = day;
                            fileInput.click();
                        });
                    }
                    
                    if (removeTypeBtn) {
                        removeTypeBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            removeType(day);
                        });
                    }
                    
                    if (noteDayBtn) {
                        noteDayBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            targetDay = day;
                            openNoteEditor(day);
                        });
                    }
                    
                    calendarGrid.appendChild(calendarDay);
                }
                
                // æ›´æ–°å½“å‰æ—¥æœŸçš„æ˜¾ç¤º
                updateDateDisplay();
            }
            
            // æ‰“å¼€å¤‡æ³¨ç¼–è¾‘å™¨
            function openNoteEditor(day) {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[day] || {};
                
                // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
                noteDateDisplay.textContent = `${currentDate.year}å¹´${currentDate.month}æœˆ${day}æ—¥`;
                
                // è®¾ç½®å½“å‰å¤‡æ³¨å†…å®¹
                noteTextarea.value = dayData.note || '';
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                noteModal.style.display = 'flex';
            }
            
            // ä¿å­˜å¤‡æ³¨
            function saveNote() {
                if (targetDay === null) return;
                
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                
                if (!imageData[monthKey]) {
                    imageData[monthKey] = {};
                }
                
                if (!imageData[monthKey][targetDay]) {
                    imageData[monthKey][targetDay] = { types: [], images: [], note: '' };
                }
                
                // æ›´æ–°å¤‡æ³¨å†…å®¹
                imageData[monthKey][targetDay].note = noteTextarea.value;
                
                // å…³é—­æ¨¡æ€æ¡†
                noteModal.style.display = 'none';
                
                // æ›´æ–°æ˜¾ç¤º
                updateDateDisplay();
                
                // å¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¿™ä¸ªæ—¥æœŸï¼Œæ›´æ–°å¤‡æ³¨æ˜¾ç¤º
                if (currentDate.day === targetDay) {
                    updateNoteDisplay();
                }
            }
            
            // æ˜¾ç¤ºç±»å‹é€‰æ‹©å™¨
            function showTypeSelector(targetElement, selectedTypes) {
                const rect = targetElement.getBoundingClientRect();
                typeSelectorMenu.style.top = `${rect.bottom + window.scrollY}px`;
                typeSelectorMenu.style.left = `${rect.left + rect.width/2}px`;
                typeSelectorMenu.classList.add('show');
                
                // æ›´æ–°é€‰ä¸­çŠ¶æ€
                document.querySelectorAll('.type-option').forEach(option => {
                    const type = option.getAttribute('data-type');
                    if (selectedTypes.includes(type)) {
                        option.classList.add('selected');
                    } else {
                        option.classList.remove('selected');
                    }
                });
                
                // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
                setTimeout(() => {
                    document.addEventListener('click', closeTypeSelector);
                }, 10);
            }
            
            // å…³é—­ç±»å‹é€‰æ‹©å™¨
            function closeTypeSelector(e) {
                if (!typeSelectorMenu.contains(e.target)) {
                    typeSelectorMenu.classList.remove('show');
                    document.removeEventListener('click', closeTypeSelector);
                }
            }
            
            // å¤„ç†æ—¥æœŸç‚¹å‡»
            function handleDayClick(day) {
                currentDate.day = day;
                updateDateDisplay();
                generateCalendar();
            }
            
            // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            function updateDateDisplay() {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                const dayData = imageData[monthKey]?.[currentDate.day] || {};
                const types = dayData.types || [];
                
                // æ›´æ–°é¡¶éƒ¨æ˜¾ç¤º
                dayNumber.textContent = currentDate.day;
                dayInfo.textContent = `${currentDate.month}æœˆ ${currentDate.year}`;
                
                // æ›´æ–°ç±»å‹æ ‡ç­¾å®¹å™¨
                typeTagContainer.innerHTML = '';
                
                if (types.length > 0) {
                    types.forEach(type => {
                        const tag = document.createElement('div');
                        tag.className = 'type-tag';
                        tag.textContent = type;
                        tag.style.background = typeColors[type] || '#95a5a6';
                        typeTagContainer.appendChild(tag);
                    });
                }
                
                // è®¾ç½®å›¾ç‰‡å°ºå¯¸
                setImageSizeByDate();
                
                // æ›´æ–°è½®æ’­å›¾
                initGallery();
            }
            
            // è®¾ç½®/ç§»é™¤ç±»å‹
            function toggleType(day, type) {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                
                if (!imageData[monthKey]) {
                    imageData[monthKey] = {};
                }
                
                if (!imageData[monthKey][day]) {
                    imageData[monthKey][day] = { types: [], images: [], note: '' };
                }
                
                const dayData = imageData[monthKey][day];
                const typeIndex = dayData.types.indexOf(type);
                
                if (typeIndex !== -1) {
                    // ç§»é™¤ç±»å‹
                    dayData.types.splice(typeIndex, 1);
                } else {
                    // æ·»åŠ ç±»å‹
                    dayData.types.push(type);
                }
                
                // å¦‚æœè¯¥æ—¥æœŸæ²¡æœ‰ç±»å‹ä¸”æ²¡æœ‰å›¾ç‰‡ï¼Œåˆ™åˆ é™¤è®°å½•
                if (dayData.types.length === 0 && dayData.images.length === 0 && !dayData.note) {
                    delete imageData[monthKey][day];
                    
                    // å¦‚æœè¯¥æœˆä»½æ²¡æœ‰å…¶ä»–è®°å½•ï¼Œåˆ™åˆ é™¤æ•´ä¸ªæœˆä»½
                    if (Object.keys(imageData[monthKey]).length === 0) {
                        delete imageData[monthKey];
                    }
                }
                
                // å¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¿™ä¸ªæ—¥æœŸï¼Œæ›´æ–°æ˜¾ç¤º
                if (currentDate.day === day) {
                    updateDateDisplay();
                }
                
                // é‡æ–°ç”Ÿæˆæ—¥å†
                generateCalendar();
            }
            
            // ç§»é™¤ç±»å‹
            function removeType(day) {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                
                if (!imageData[monthKey] || !imageData[monthKey][day]) {
                    return;
                }
                
                // åˆ é™¤ç±»å‹
                imageData[monthKey][day].types = [];
                
                // å¦‚æœè¯¥æ—¥æœŸæ²¡æœ‰å›¾ç‰‡å’Œå¤‡æ³¨ï¼Œåˆ™åˆ é™¤è®°å½•
                if (imageData[monthKey][day].images.length === 0 && !imageData[monthKey][day].note) {
                    delete imageData[monthKey][day];
                    
                    // å¦‚æœè¯¥æœˆä»½æ²¡æœ‰å…¶ä»–è®°å½•ï¼Œåˆ™åˆ é™¤æ•´ä¸ªæœˆä»½
                    if (Object.keys(imageData[monthKey]).length === 0) {
                        delete imageData[monthKey];
                    }
                }
                
                // å¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¿™ä¸ªæ—¥æœŸï¼Œæ›´æ–°æ˜¾ç¤º
                if (currentDate.day === day) {
                    updateDateDisplay();
                }
                
                // é‡æ–°ç”Ÿæˆæ—¥å†
                generateCalendar();
            }
            
            // ç±»å‹é€‰æ‹©äº‹ä»¶
            document.querySelectorAll('.type-option').forEach(option => {
                option.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    if (targetDay !== null) {
                        toggleType(targetDay, type);
                    }
                    typeSelectorMenu.classList.remove('show');
                    document.removeEventListener('click', closeTypeSelector);
                });
            });
            
            // å¹´ä»½é€‰æ‹©äº‹ä»¶
            yearSelect.addEventListener('change', function() {
                currentDate.year = parseInt(this.value);
                currentDate.day = 1;
                generateCalendar();
            });
            
            // æœˆä»½åˆ‡æ¢åŠŸèƒ½
            prevBtn.addEventListener('click', function() {
                if (currentDate.month === 1) {
                    currentDate.month = 12;
                    currentDate.year--;
                } else {
                    currentDate.month--;
                }
                currentDate.day = 1;
                generateCalendar();
            });
            
            nextBtn.addEventListener('click', function() {
                if (currentDate.month === 12) {
                    currentDate.month = 1;
                    currentDate.year++;
                } else {
                    currentDate.month++;
                }
                currentDate.day = 1;
                generateCalendar();
            });
            
            // å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½
            uploadBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                if (files.length === 0) return;
                
                const validImages = files.filter(file => file.type.match('image.*'));
                if (validImages.length === 0) {
                    alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
                    return;
                }
                
                // æ˜¾ç¤ºé¢„è§ˆå®¹å™¨
                previewContainer.style.display = 'flex';
                previewContainer.innerHTML = '';
                uploadStatus.style.display = 'block';
                uploadStatus.textContent = `å‡†å¤‡ä¸Šä¼  ${validImages.length} å¼ å›¾ç‰‡...`;
                
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                if (!imageData[monthKey]) {
                    imageData[monthKey] = {};
                }
                
                if (!imageData[monthKey][currentDate.day]) {
                    imageData[monthKey][currentDate.day] = {
                        types: ["Gacha Festival"],
                        images: [],
                        note: ""
                    };
                }
                
                // è¯»å–æ‰€æœ‰å›¾ç‰‡
                let loadedCount = 0;
                validImages.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // æ·»åŠ å›¾ç‰‡åˆ°é¢„è§ˆ
                        const previewItem = document.createElement('div');
                        previewItem.className = 'preview-item';
                        previewItem.innerHTML = `
                            <img src="${e.target.result}" alt="é¢„è§ˆ">
                            <div class="remove-preview">Ã—</div>
                        `;
                        previewContainer.appendChild(previewItem);
                        
                        // æ·»åŠ åˆ°æ•°æ®
                        imageData[monthKey][currentDate.day].images.push(e.target.result);
                        loadedCount++;
                        
                        // æ›´æ–°çŠ¶æ€
                        uploadStatus.textContent = `å·²ä¸Šä¼  ${loadedCount}/${validImages.length} å¼ å›¾ç‰‡`;
                        
                        // å½“æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæˆå
                        if (loadedCount === validImages.length) {
                            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                            uploadStatus.textContent = `æˆåŠŸä¸Šä¼  ${validImages.length} å¼ å›¾ç‰‡åˆ° ${currentDate.year}å¹´${currentDate.month}æœˆ${currentDate.day}æ—¥ï¼`;
                            
                            // 3ç§’åéšè—çŠ¶æ€æ¶ˆæ¯
                            setTimeout(() => {
                                uploadStatus.style.display = 'none';
                                previewContainer.style.display = 'none';
                            }, 3000);
                            
                            // æ›´æ–°æ˜¾ç¤º
                            updateDateDisplay();
                        }
                    };
                    
                    reader.readAsDataURL(file);
                });
            });
            
            // åˆ é™¤è®°å½•åŠŸèƒ½
            removeBtn.addEventListener('click', function() {
                const monthKey = `${currentDate.year}-${currentDate.month}`;
                
                if (!imageData[monthKey] || !imageData[monthKey][currentDate.day]) {
                    alert('å½“å‰æ—¥æœŸæ²¡æœ‰è®°å½•å¯åˆ é™¤ï¼');
                    return;
                }
                
                // åˆ é™¤è®°å½•
                delete imageData[monthKey][currentDate.day];
                
                // å¦‚æœè¯¥æœˆä»½æ²¡æœ‰å…¶ä»–è®°å½•ï¼Œåˆ™åˆ é™¤æ•´ä¸ªæœˆä»½
                if (Object.keys(imageData[monthKey]).length === 0) {
                    delete imageData[monthKey];
                }
                
                // æ˜¾ç¤ºç©ºç™½çŠ¶æ€
                imageContainer.classList.add('empty');
                noteContainer.style.display = 'none';
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                alert(`å·²åˆ é™¤ ${currentDate.year}å¹´${currentDate.month}æœˆ${currentDate.day}æ—¥ çš„å…¨éƒ¨è®°å½•`);
                
                // æ›´æ–°æ—¥å†
                generateCalendar();
            });
            
            // ä¿å­˜æ•°æ®åŠŸèƒ½
            saveDataBtn.addEventListener('click', function() {
                // å°†æ•°æ®è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
                const dataStr = JSON.stringify(imageData, null, 2);
                
                // åˆ›å»ºBlobå¯¹è±¡
                const blob = new Blob([dataStr], {type: 'application/json'});
                
                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `cocoppa-gacha-data-${new Date().toISOString().slice(0,10)}.json`;
                
                // æ·»åŠ é“¾æ¥åˆ°é¡µé¢å¹¶è§¦å‘ä¸‹è½½
                document.body.appendChild(a);
                a.click();
                
                // æ¸…ç†
                setTimeout(() => {
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }, 0);
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                alert('æ‰­è›‹æ•°æ®å·²æˆåŠŸä¿å­˜ï¼');
            });
            
            // åˆ†äº«æ•°æ®åŠŸèƒ½
            shareDataBtn.addEventListener('click', function() {
                // ç”Ÿæˆä¸€ä¸ªç®€å•çš„éšæœºIDä½œä¸ºåˆ†äº«æ ‡è¯†
                const shareId = Math.random().toString(36).substring(2, 10);
                
                // è®¾ç½®åˆ†äº«é“¾æ¥ï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥æ˜¯æœåŠ¡å™¨ç”Ÿæˆçš„é“¾æ¥ï¼‰
                const shareUrl = `https://cocoppa-play-calendar.com/share/${shareId}`;
                shareUrlInput.value = shareUrl;
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                shareModal.style.display = 'flex';
            });
            
            // å…³é—­åˆ†äº«æ¨¡æ€æ¡†
            closeShareModal.addEventListener('click', function() {
                shareModal.style.display = 'none';
                copySuccess.style.display = 'none';
            });
            
            // å¤åˆ¶åˆ†äº«é“¾æ¥
            copyShareBtn.addEventListener('click', function() {
                shareUrlInput.select();
                document.execCommand('copy');
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                copySuccess.style.display = 'block';
                
                // 3ç§’åéšè—æˆåŠŸæ¶ˆæ¯
                setTimeout(() => {
                    copySuccess.style.display = 'none';
                }, 3000);
            });
            
            // æ¸…é™¤æ‰€æœ‰æ•°æ®åŠŸèƒ½
            clearDataBtn.addEventListener('click', function() {
                clearConfirmModal.style.display = 'flex';
            });
            
            // å…³é—­æ¸…é™¤ç¡®è®¤æ¨¡æ€æ¡†
            closeClearModal.addEventListener('click', function() {
                clearConfirmModal.style.display = 'none';
            });
            
            cancelClearBtn.addEventListener('click', function() {
                clearConfirmModal.style.display = 'none';
            });
            
            // ç¡®è®¤æ¸…é™¤æ‰€æœ‰æ•°æ®
            confirmClearBtn.addEventListener('click', function() {
                // æ¸…é™¤æ‰€æœ‰æ•°æ®
                imageData = {};
                
                // å…³é—­æ¨¡æ€æ¡†
                clearConfirmModal.style.display = 'none';
                
                // æ›´æ–°æ˜¾ç¤º
                imageContainer.classList.add('empty');
                noteContainer.style.display = 'none';
                
                // é‡æ–°ç”Ÿæˆæ—¥å†
                generateCalendar();
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                alert('æ‰€æœ‰æ‰­è›‹æ•°æ®å·²æˆåŠŸæ¸…é™¤ï¼');
            });
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            window.addEventListener('click', function(e) {
                if (e.target === shareModal) {
                    shareModal.style.display = 'none';
                    copySuccess.style.display = 'none';
                }
                if (e.target === clearConfirmModal) {
                    clearConfirmModal.style.display = 'none';
                }
                if (e.target === noteModal) {
                    noteModal.style.display = 'none';
                }
            });
            
            // è½®æ’­å›¾å¯¼èˆª
            galleryPrev.addEventListener('click', prevSlide);
            galleryNext.addEventListener('click', nextSlide);
            
            // å¤‡æ³¨ç›¸å…³äº‹ä»¶
            editNoteBtn.addEventListener('click', function() {
                openNoteEditor(currentDate.day);
            });
            
            noteSaveBtn.addEventListener('click', saveNote);
            
            noteCancelBtn.addEventListener('click', function() {
                noteModal.style.display = 'none';
            });
            
            closeNoteModal.addEventListener('click', function() {
                noteModal.style.display = 'none';
            });
            
            // è¡¨æƒ…ç¬¦å·æŒ‰é’®äº‹ä»¶
            document.querySelectorAll('.emoji-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const emoji = this.getAttribute('data-emoji');
                    const cursorPos = noteTextarea.selectionStart;
                    const text = noteTextarea.value;
                    
                    // åœ¨å…‰æ ‡ä½ç½®æ’å…¥è¡¨æƒ…ç¬¦å·
                    noteTextarea.value = text.substring(0, cursorPos) + emoji + text.substring(cursorPos);
                    
                    // è®¾ç½®å…‰æ ‡ä½ç½®
                    noteTextarea.selectionStart = cursorPos + emoji.length;
                    noteTextarea.selectionEnd = cursorPos + emoji.length;
                    
                    // ä¿æŒç„¦ç‚¹
                    noteTextarea.focus();
                });
            });
            
            // æœˆä»½æ•°æ®ç”Ÿæˆå‡½æ•°
            function getMonthData(year, month) {
                // å„æœˆä»½çš„å¤©æ•°
                const daysInMonth = {
                    1: 31,
                    2: (year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)) ? 29 : 28,
                    3: 31,
                    4: 30,
                    5: 31,
                    6: 30,
                    7: 31,
                    8: 31,
                    9: 30,
                    10: 31,
                    11: 30,
                    12: 31
                };
                
                // è·å–æœˆä»½ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ 
                const firstDay = new Date(year, month - 1, 1).getDay();
                
                return {
                    name: month + "æœˆ",
                    days: daysInMonth[month],
                    startDay: firstDay
                };
            }
            
            // åˆå§‹åŒ–æ—¥å†å’Œè½®æ’­å›¾
            initYearSelector(); // åˆå§‹åŒ–å¹´ä»½é€‰æ‹©å™¨
            generateCalendar();
        });
    </script>
</body>
</html>
